<!-- vim: set encoding=utf8 fileencoding=utf8: -->
{% extends "in_session.html" %}
{% load i18n %}

{% block javascript %}
    <script type="text/javascript" src="/media/js/jquery-1.1.3.1.pack.js"></script>
    <script type="text/javascript" src="/media/js/jquery.tablesorter.js"></script>
{% endblock javascript %}

{% block menu %}
<p><a href="/logout/">{% trans "Log out" %}</a></p>
<p><a href="/learning/profile/">{% trans "My account" %}</a></p>
<p><a href="/learning/tdb/">{% trans "Dashboard" %}</a></p>
<p><a href="/coaching/">{% trans "Administration" %}</a></p>
{% endblock menu %}

{% block breadcrumb %}
<a href="/coaching/">{% trans "administration" %}</a>
&gt; {% trans "students" %}
{% endblock breadcrumb %}

{% block content %}
<div id="rightcol">
	<h2>{% trans "Filter" %}</h2>
    {% for filtre in liste_filtres %}
    <h3>{% trans "By " %}{{ filtre.title }}</h3>
	<ul>
        {% for item in filtre.valeurs %}
        {% if item.selected %}<li class="selected">{{ item.libel }}{% else %}<li><a href="?{{ item.url }}">{{ item.libel }}</a>{% endif %}</li>
		{% endfor %}
	</ul>	
    {% endfor %}
</div>

{% if liste_utilisateurs %}
<h2>{% trans "Students management" %} 
{% if gid %}
 - {{ gid.nom }}</h2>
<p class="nop"><a href="/coaching/sendmail/?gid={{ gid.id }}">{% trans "Send a mail to this group" %}</a></p>
{%if gid.workdone %}
<p class="nop">{% trans "Download works from this group:" %}</p>
<ul>
{% for work in gid.workdone %}
<li class="nop"><a href="/upload/workdone/{{ work }}">{{ work }}</a></li>
{% endfor %}
</ul>
{% else %}
</h2>
{% endif %}
{% else %}
</h2>
<p class="nop"><a href="/coaching/csv/?gid={{ gid.id }}">{% trans "Save this table as a .csv file" %}</a></p>
{% endif %}

<script type="text/javascript">
    $(document).ready(function() {
        $("#lista").tablesorter({ widgets: ['zebra']});
		{% if gid %}
		var c = [[0,0]];
		{% else %}
		var c = [[0,0],[1,0]];
		{% endif %}
        $("#lista").trigger("sorton",[c]);
        return false;
})
</script>
	<table id="lista">
		<thead>
			<tr>
				{% if not gid %}
				<th>{% trans "Group" %}</th>
				{% endif %}
				<th>{% trans "Name" %}</th>
				<th>{% trans "Login" %}</th>
				<th style="text-align: center;">{% trans "Modules" %}</th>
				<th style="text-align: center;">{% trans "Done" %}</th>
				<th style="text-align: center;">{% trans "Done Late" %}</th>
				<th style="text-align: center;">{% trans "Cur. Late" %}</th>
				<th style="text-align: center;">{% trans "Time Spent" %}</th>
				<th style="text-align: center;">{% trans "Last Work" %}</th>
			</tr>
		</thead>
		<tbody>
			{% for utilisateur in liste_utilisateurs %}
            <tr>
				{% if not gid %}
				<td>{{ utilisateur.groupe.nom }}</td>
				{% endif %}
				<td>{{ utilisateur.nom_prenom }}</td>
				<td><a href="/coaching/detail/?id={{ utilisateur.id }}">{{ utilisateur.login }}</a></td>
				<td style="text-align: center;">{{ utilisateur.nb_modules }}</td>
                <td style="text-align: center;">{{ utilisateur.nb_valides }}</td>
                <td style="text-align: center;">{{ utilisateur.nb_retards }}</td>
				<td style="text-align: center;">{{ utilisateur.perfs.2 }}</td>
				<td style="text-align: center;">{{ utilisateur.time_elapsed }}</td>
                <td style="text-align: center;">{% if utilisateur.lastw %}{{ utilisateur.lastw }}{% endif %}</td>
			</tr>
			{% endfor %}
		</tbody>
	</table>
	{% else %}
	<p>{% trans "This group is empty" %}</p>
{% endif %}
{% endblock content %}
